---
import LanguageSwitcher from '../../i18n/LanguageSwitcher.astro';
import { t, type Locale } from '../../../i18n/i18n';
import { logos } from '../../../config/assets';
import type { HeaderColorConfig } from '../../../config/headerColors';
import LazyImage from '../LazyImage.astro';

export interface Props {
  currentLang: Locale;
  headerColorConfig: HeaderColorConfig;
}

const { currentLang, headerColorConfig } = Astro.props;

// Get current path to determine active menu item
const { pathname } = Astro.url;
const currentPath = pathname;

// Obtener los datos de social media y men√∫ desde las traducciones
const menuItems = t('menu_items', { namespace: 'common', locale: currentLang }) as any[];

const leftMenuItems = Array.isArray(menuItems) ? menuItems.slice(0, 2) : [];
const rightMenuItems = Array.isArray(menuItems) ? menuItems.slice(2) : [];
---

<!-- Desktop Navigation -->
<nav class={`hidden md:grid grid-cols-3 items-center w-full py-3 px-6 ${headerColorConfig.backgroundColor}`} data-current-lang={currentLang}>
  <!-- Left menu -->
  <div class="flex items-center justify-start gap-8" id="desktop-menu-left">
    {leftMenuItems.map((item: any) => (
      <div class="relative group">
        <a
          href={item.href}
          class={`font-title text-xl uppercase font-medium transition-colors py-2 px-1 rounded-md flex items-center ${headerColorConfig.textColor} ${headerColorConfig.hoverTextColor} ${!item.href.startsWith('#') && currentPath === item.href ? 'opacity-80' : ''}`}
        >
          {item.text}
        </a>
      </div>
    ))}
  </div>

  <!-- Center logo -->
  <div class="flex items-center justify-center">
    <a href={`/${currentLang}/`} class="block">
      <img src={logos.principal.url} alt={logos.principal.alt} class="h-20 w-auto" />
    </a>
  </div>

  <!-- Right menu + controls -->
  <div class="flex items-center justify-end gap-6">
    <div class="flex items-center gap-8" id="desktop-menu-right">
      {rightMenuItems.map((item: any) => (
        <div class="relative group">
          <a 
            href={item.href} 
            class={`font-title text-xl uppercase font-medium transition-colors py-2 px-1 rounded-md flex items-center ${headerColorConfig.textColor} ${headerColorConfig.hoverTextColor} ${!item.href.startsWith('#') && currentPath === item.href ? 'opacity-80' : ''}`}
          >
            {item.text}
            {item.submenu && (
              <svg class="w-4 h-4 ml-1 fill-current" viewBox="0 0 20 20"><path d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" /></svg>
            )}
          </a>
          {item.submenu && (
            <div class="absolute left-0 mt-0 w-48 bg-white text-gray-800 rounded-md shadow-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 ease-in-out invisible group-hover:visible z-50 py-1">
              {item.submenu.map((subItem: any) => (
                <div class="relative group/submenu">
                  <a href={subItem.href} class="px-4 py-2 text-sm font-sans hover:bg-quinary flex justify-between items-center transition-colors duration-200 ${!subItem.href.startsWith('#') && currentPath === subItem.href ? 'bg-quinary' : ''}">
                    {subItem.text}
                    {subItem.submenu && (
                      <svg class="w-3 h-3 ml-1 fill-current" viewBox="0 0 20 20"><path d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 01-1.414 0z" /></svg>
                    )}
                  </a>
                  {subItem.submenu && (
                    <div class="absolute left-full top-0 w-48 bg-white text-gray-800 rounded-md shadow-lg opacity-0 group-hover/submenu:opacity-100 transition-opacity duration-200 ease-in-out invisible group-hover/submenu:visible z-50 py-1">
                      {subItem.submenu.map((thirdItem: any) => (
                        <a href={thirdItem.href} class="block px-4 py-2 text-sm font-sans hover:bg-quinary transition-colors duration-200 ${!thirdItem.href.startsWith('#') && currentPath === thirdItem.href ? 'bg-quinary' : ''}">{thirdItem.text}</a>
                      ))}
                    </div>
                  )}
                </div>
              ))}
            </div>
          )}
        </div>
      ))}
    </div>
    <LazyImage src="https://snack.yummiespromociones.com/SnacksyummiesAssets/Gemini_Generated.webp" alt={logos.principal.alt} class="h-20 w-auto" />
    <!-- Language Switcher -->
    <LanguageSwitcher activeLocale={currentLang} headerColorConfig={headerColorConfig} />

    
    
    <!-- Yummies One -->
    <!-- <a href="/yummies-one" class="flex items-center text-white hover:text-gray-300 uppercase text-sm font-medium">
      <span>Yummies One</span>
    </a> -->
  </div>
</nav>
