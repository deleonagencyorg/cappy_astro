---
import { routesConfig, getRouteById } from '../../config/routes';
import { setLocale, t, type Locale } from '../../i18n/i18n';
import MainLayout from '../../layouts/MainLayout.astro';
// Importa el componente de contenido directamente
import HomePageContent from '../../views/Home/index.astro';

export async function getStaticPaths() {
  const homeRoute = getRouteById('home');
  if (!homeRoute) return [];

  return Object.keys(homeRoute.slugs).map(lang => ({
    params: { lang },
  }));
}

const { lang } = Astro.params as { lang: Locale };
setLocale(lang);

const homeRoute = getRouteById('home');
if (!homeRoute) {
  // Manejar el caso en que la ruta 'home' no esté definida, aunque getStaticPaths debería prevenir esto.
  // Podrías redirigir a 404 o mostrar un error.
  throw new Error("Home route configuration is missing.");
}

const pageTitle = homeRoute.metaTitleKey ? t(homeRoute.metaTitleKey) : 'Home';
const pageDescription = homeRoute.metaDescriptionKey ? t(homeRoute.metaDescriptionKey) : '';

const ContentComponent = HomePageContent; // Asignación directa para la página de inicio

// SEO Keywords based on language
const seoKeywords = lang === 'es' 
  ? 'snacks centroamérica, taqueritos, zambos, ranchitas, snacks honduras, snacks guatemala, marca líder snacks, Cappy'
  : 'central america snacks, food, honduras snacks, guatemala snacks, leading snack brand, Cappy, taqueritos, zambos, ranchitas';
---
<MainLayout title={pageTitle} description={pageDescription}>
  <Fragment slot="head">
    <!-- SEO Meta Tags -->
    <meta name="keywords" content={seoKeywords}>
    <meta name="author" content="Cappy">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href={`https://www.cappysnacks.com/${lang}/`}>
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content={`Cappy - ${pageTitle}`}>
    <meta property="og:description" content={pageDescription}>
    <meta property="og:image" content="https://www.cappysnacks.com/logo.png">
    <meta property="og:url" content={`https://www.cappysnacks.com/${lang}/`}>
    <meta property="og:type" content="website"> 
    <meta property="og:site_name" content="Cappy">
    <meta property="og:locale" content={lang === 'es' ? 'es_ES' : 'en_US'}>
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content={`Cappy - ${pageTitle}`}>
    <meta name="twitter:description" content={pageDescription}>
    <meta name="twitter:image" content="https://www.cappysnacks.com/logo.png">
    
    <!-- Structured Data -->
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Cappy Snacks",
      "alternateName": "Cappy Yummies",
      "url": lang === 'es' ? "https://www.cappysnacks.com/es/" : "https://www.cappysnacks.com/en/",
      "logo": "https://www.cappysnacks.com/logo.png",
      "description": lang === 'es' ? "Cappy es la marca líder de snacks extruidos de maíz en Centroamérica, ofreciendo productos crujientes con sabores intensos y variados." : "Cappy is the leading brand of corn extruded snacks in Central America, offering crispy products with intense and varied flavors.",
      "sameAs": [
        "https://www.facebook.com/SnacksYummies",
        "https://www.instagram.com/snacksyummies",
        "https://www.tiktok.com/@snacksyummies"
      ],
      "contactPoint": {
        "@type": "ContactPoint",
        "contactType": "Customer Service",
        "telephone": "+504-2275-3370",
        "areaServed": ["HN", "GT", "SV", "CR", "NI", "DO"]
      },
      "address": {
        "@type": "PostalAddress",
        "streetAddress": "Barrio Morazán, Frente a Plantas Tropicales, Bulevar Suyapa",
        "addressLocality": "Tegucigalpa",
        "addressRegion": "Francisco Morazán",
        "postalCode": "Honduras",
        "addressCountry": "HN"
      }
    })}></script>
    
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Cappy Snacks",
      "url": lang === 'es' ? "https://www.cappysnacks.com/es/" : "https://www.cappysnacks.com/en/",
      "description": lang === 'es' ? "Cappy es la marca líder de snacks extruidos de maíz en Centroamérica, ofreciendo productos crujientes con sabores intensos y variados." : "Cappy is the leading brand of corn extruded snacks in Central America, offering crispy products with intense and varied flavors.",
      "inLanguage": lang === 'es' ? "es-ES" : "en-US"
    })}></script>
    
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": lang === 'es' ? "Inicio" : "Home",
          "item": `https://www.cappysnacks.com/${lang}/`
        }
      ]
    })}></script>
  </Fragment>
  <ContentComponent />
</MainLayout>

